import os, sys
import serial
import time

unlockMaster1=[0x50, 0x06, 0x00, 0x69, 0xB5, 0x88, 0x22, 0xA1];
accCalmode1=[0x50, 0x06, 0x00, 0x01, 0x00, 0x01, 0x14, 0x4B];
magCalmode1=[0x50, 0x06, 0x00, 0x01, 0x00, 0x07, 0x94, 0x49];
setNormal1=[0x50, 0x06, 0x00, 0x01, 0x00, 0x00, 0xD5, 0x8B];
saveConfig1=[0x50, 0x06, 0x00, 0x00, 0x00, 0x00, 0x84, 0x4B];
readAngle1= [0x50, 0x03, 0x00, 0x3d, 0x00, 0x03, 0x99, 0x86];
readAcc1= [0x50, 0x03, 0x00, 0x34, 0x00, 0x03, 0x49, 0x84];
readAngVel1= [0x50, 0x03, 0x00, 0x37, 0x00, 0x03, 0xB9, 0x84];

rs485 = serial.Serial('/dev/ttyUSB0',9600, timeout = 5)

def calibrate():
    rs485.write(bytes(bytearray(unlockMaster1)))
    time.sleep(0.5)
    rs485.write(bytes(bytearray(unlockMaster1)))
    time.sleep(5)
    rs485.write(bytes(bytearray(unlockMaster1)))
    time.sleep(1)
    rs485.write(bytes(bytearray(unlockMaster1)))

    #read trash buffer
    while True:
        line = rs485.read(100)
        if len(line) == 0:
                break;

        hex_list = ["{:x}".format(ord(c)) for c in line];
        print ''.join(hex_list)

